!function(a){"use strict";a.AxisBuilderHistory=a.AxisBuilderHistory||{},a.AxisBuilderHistory=function(b){var c={steps:40,button:"",canvas:"",editor:""};return"undefined"==typeof Storage?!1:(this.doc=a(document),this.options=a.extend({},c,b),void this.setups())},a.AxisBuilderHistory.prototype={setups:function(){this.button=a(this.options.button),this.canvas=a(this.options.canvas),this.editor=a(this.options.editor),this.key=this.create_array_key(),this.storage=this.get()||[],this.maximum=this.storage.length-1,this.index=this.get(this.key+"index"),("undefined"==typeof this.index||null===this.index)&&(this.index=this.maximum),this.undoButton=this.button.find(".undo-data"),this.redoButton=this.button.find(".redo-data"),this.clear(),this.bindEvents()},create_array_key:function(){var a="axisbuilder"+axisbuilder_admin_meta_boxes_builder.theme_name+axisbuilder_admin_meta_boxes_builder.theme_version+axisbuilder_admin_meta_boxes_builder.post_id+axisbuilder_admin_meta_boxes_builder.plugin_version;return a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()},bindEvents:function(){var a=this;this.canvas.on("axisbuilder-storage-update",function(){a.snapshot()}),this.button.on("click","a.undo-data",function(){return a.undo(),!1}),this.button.on("click","a.redo-data",function(){return a.redo(),!1}),this.doc.bind("keydown.AxisBuilderHistory",function(b){b=b||window.event,90===b.which&&(b.ctrlKey||b.ctrlKey&&b.shiftKey)&&(setTimeout(function(){a.undo()},100),b.stopImmediatePropagation()),89===b.which&&(b.ctrlKey||b.ctrlKey&&b.shiftKey)&&(setTimeout(function(){a.redo()},100),b.stopImmediatePropagation())})},get:function(a){var b=a||this.key;return JSON.parse(sessionStorage.getItem(b))},set:function(a,b){var c=a||this.key,d=b||JSON.stringify(this.storage);try{sessionStorage.setItem(c,d)}catch(e){console.log("Storage Limit reached. Your Browser does not offer enough session storage to save more steps for the undo/redo history.","Storage"),console.log(e,"Storage"),this.clear(),this.redoButton.addClass("inactive-history"),this.undoButton.addClass("inactive-history")}},clear:function(){sessionStorage.removeItem(this.key),sessionStorage.removeItem(this.key+"index"),this.storage=[],this.index=null},undo:function(){return this.index-1>=0&&(this.index--,this.canvasUpdate(this.storage[this.index])),!1},redo:function(){return this.index+1<=this.maximum&&(this.index++,this.canvasUpdate(this.storage[this.index])),!1},canvasUpdate:function(a){"undefined"==typeof this.tinyMCE&&(this.tinyMCE="undefined"==typeof window.tinyMCE?!1:window.tinyMCE.get(this.options.editor.replace("#",""))),this.tinyMCE&&this.tinyMCE.setContent(window.switchEditors.wpautop(a[0]),{format:"html"}),this.editor.val(a[0]),this.canvas.html(a[1]),sessionStorage.setItem(this.key+"index",this.index),this.index<=0?this.undoButton.addClass("inactive-history"):this.undoButton.removeClass("inactive-history"),this.index+1>this.maximum?this.redoButton.addClass("inactive-history"):this.redoButton.removeClass("inactive-history"),this.canvas.trigger("axisbuilder-history-update")},snapshot:function(){this.canvas.find("textarea").each(function(){this.innerHTML=this.value}),this.storage=this.storage||this.get()||[],this.index=this.index||this.get(this.key+"index"),("undefined"==typeof this.index||null===this.index)&&(this.index=this.storage.length-1);var a=[this.editor.val(),this.canvas.html().replace(/modal-animation/g,"")],b=this.storage[this.index];("undefined"==typeof b||b[0]!==a[0])&&(this.index++,this.storage=this.storage.slice(0,this.index),this.storage.push(a),this.options.steps<this.storage.length&&this.storage.shift(),this.set()),this.maximum=this.storage.length-1,1===this.storage.length||0===this.index?this.undoButton.addClass("inactive-history"):this.undoButton.removeClass("inactive-history"),this.storage.length-1===this.index?this.redoButton.addClass("inactive-history"):this.redoButton.removeClass("inactive-history")}},a(document).ready(function(){new a.AxisBuilderHistory({button:".history-action",canvas:".canvas-area",editor:".canvas-data"})})}(jQuery),function(a){"use strict";a.AxisBuilderHelper=a.AxisBuilderHelper||{},a.AxisBuilderHelper.wp_media=a.AxisBuilderHelper.wp_media||[],a(document).ready(function(){a.AxisBuilderHelper.check_depedencies(),a.AxisBuilderHelper.wp_media_advanced()}),a.AxisBuilderHelper.check_depedencies=function(){var b=a("body");b.on("change",".axisbuilder-style input[type=hidden], .axisbuilder-style input[type=text], .axisbuilder-style input[type=checkbox], .axisbuilder-style textarea, .axisbuilder-style select, .axisbuilder-style radio",function(){var c=a(this),d=c.parents(".axisbuilder-modal:eq(0)");d.length||(d=b);var e=this.id.replace(/axisbuilderTB-/,""),f=d.find('.axisbuilder-form-element-container[data-check-element="'+e+'"]'),g=c.parents(".axisbuilder-form-element-container:eq(0)").is(".axisbuilder-hidden"),h=this.value;return c.is("input[type=checkbox]")&&!c.prop("checked")&&(h=""),f.length?void f.each(function(){var b=!1,c=a(this),d=c.data("check-operator"),e=c.data("check-value").toString();if(!g)switch(d){case"equals":b=h===e?!0:!1;break;case"not":b=h!==e?!0:!1;break;case"is_larger":b=h>e?!0:!1;break;case"is_smaller":b=e>h?!0:!1;break;case"contains":b=-1!==h.indexOf(e)?!0:!1;break;case"doesnot_contain":b=-1===h.indexOf(e)?!0:!1;break;case"is_empty_or":b=""===h||h===e?!0:!1;break;case"not_empty_and":b=""!==h||h!==e?!0:!1}b===!0&&c.is(".axisbuilder-hidden")?(c.css({display:"none"}).removeClass("axisbuilder-hidden").find("select, radio, input[type=checkbox]").trigger("change"),c.slideDown()):b!==!1||c.is(".axisbuilder-hidden")||(c.css({display:"block"}).addClass("axisbuilder-hidden").find("select, radio, input[type=checkbox]").trigger("change"),c.slideUp())}):!0})},a.AxisBuilderHelper.wp_media_advanced=function(){var b=[],c=wp.media;a("body").on("click",".axisbuilder-image-upload",function(d){d.preventDefault();var e=a(this),f=e.data(),g=_.random(0,1e18);return a.AxisBuilderHelper.wp_media.unshift(this),b[g]?void b[g].open():(b[g]=wp.media({frame:f.frame,state:f.state,className:f["class"],button:{text:f.button},library:{type:"image"}}),b[g].states.add([new wp.media.controller.Library({id:"axisbuilder_insert_single",title:e.data("title"),priority:20,editable:!0,multiple:!1,toolbar:"select",filterable:"uploaded",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!1,library:c.query(b[g].options.library)})]),b[g].on("close",function(){_.defer(function(){a.AxisBuilderHelper.wp_media.shift()})}),void b[g].open())})}}(jQuery);