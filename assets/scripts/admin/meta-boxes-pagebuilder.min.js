jQuery(function(a){var b={pagebuilder:null,init:function(){this.pagebuilder=a("#axisbuilder-editor").find(":input.axisbuilder-status"),this.undo_redo.init(),this.stupidtable.init(),this.shortcode_interface(),a("a.axisbuilder-toggle-editor").click(this.toggle_editor),a("#axisbuilder-editor").on("click",".insert-shortcode",this.add_element).on("click",".axisbuilder-edit",this.edit_element).on("click","a.axisbuilder-clone",this.clone_element).on("click","a.axisbuilder-trash",this.trash_element).on("click","a.undo-data",this.undo_redo.undo_data).on("click","a.redo-data",this.undo_redo.redo_data).on("click","a.trash-data",this.trash_data).on("click","a.axisbuilder-change-column-size:not(.axisbuilder-change-cell-size)",this.resize_layout).on("click","a.axisbuilder-cell-add",this.cell.add_cell).on("click","a.axisbuilder-cell-set",this.cell.set_cell_size).on("change","select.axisbuilder-recalculate-shortcode",this.select_changed),a("body").on("axisbuilder_backbone_modal_loaded",this.backbone.init).on("axisbuilder_backbone_modal_response",this.backbone.response),a(".canvas-area").on("axisbuilder_history_update",this.undo_redo.history_update).on("axisbuilder_storage_update",this.undo_redo.storage_update),a(document).bind("keyup.axisbuilder_history",this.undo_redo.keyboard_actions)},tiptip:function(){a("#tiptip_holder").removeAttr("style"),a("#tiptip_arrow").removeAttr("style"),a(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},block:function(){a("#axisbuilder-editor").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){a("#axisbuilder-editor").unblock()},toggle_editor:function(c){c.preventDefault();var d=a(this);d.is(".disabled")||("active"!==b.pagebuilder.val()?(a("#axisbuilder-editor").removeClass("axisbuilder-hidden"),a("#postdivrich").parent().addClass("axisbuilder-hidden-editor"),d.removeClass("button-primary").addClass("button-secondary").text(a(this).data("editor")),b.pagebuilder.val("active"),"object"==typeof window.wp.editor.dfw&&window.wp.editor.dfw.off(),setTimeout(function(){b.shortcode_interface()},10)):(a("#axisbuilder-editor").addClass("axisbuilder-hidden"),a("#postdivrich").parent().removeClass("axisbuilder-hidden-editor"),d.addClass("button-primary").removeClass("button-secondary").text(a(this).data("builder")),b.pagebuilder.val("inactive"),a(".canvas-area").find(">*:not( .control-bar, .axisbuilder-insert-area )").remove(),"object"==typeof window.editorExpand&&(window.editorExpand.off(),window.editorExpand.on()),"yes"===axisbuilder_admin_meta_boxes_builder.debug_mode&&-1!==a(".canvas-data").val().indexOf("[")&&(console.log("Switching to Classic Editor. Page Builder is in Debug Mode and will empty the textarea so user can't edit shortcode directly."),"undefined"!=typeof window.tinyMCE&&(window.tinyMCE.get("content").setContent("",{format:"html"}),a("#content.wp-editor-area").val("")))))},shortcode_interface:function(c){if("active"===b.pagebuilder.val()){"undefined"==typeof c&&(c=a(".canvas-data").val(),-1===c.indexOf("[")&&(c=a("#content.wp-editor-area").val(),"undefined"!=typeof window.tinyMCE&&(c=window.switchEditors._wp_Nop(c)),a(".canvas-data").val(c)));var d={text:c,action:"axisbuilder_shortcodes_to_interface"};b.block(),a.ajax({url:axisbuilder_admin_meta_boxes_builder.ajax_url,data:d,type:"POST",success:function(a){b.send_to_canvas(a),b.history_snapshot(),b.tiptip(),b.unblock(),b.stupidtable.init()}})}},send_to_canvas:function(c){var d=a(c);a(".canvas-area").append(d),b.dragdrop.draggable(),b.dragdrop.droppable()},add_element:function(){var c=this.hash.replace("#",""),d=a("#axisbuilder-tmpl-"+c),e="instant-insert";return d.length&&"instant-insert"===e&&(b.send_to_canvas(d.html()),b.textarea.outer(),b.history_snapshot()),!1},edit_element:function(){var b=a(this).parents(".axisbuilder-sortable-element:eq(0)");return b.length||(b=a(this).parents(".axisbuilder-layout-cell:eq(0)"),b.length||(b=a(this).parents(".axisbuilder-layout-section:eq(0)"))),a(this).AxisBuilderBackboneModal({title:b.data("modal-title"),screen:b.data("modal-class"),message:"Fetch options field with validation using AJAX...",template:"#tmpl-axisbuilder-modal-edit-element"}),!1},clone_element:function(){var d=a(this).parents(".axisbuilder-sortable-element:eq(0)"),e=!1;if(d.length||(d=a(this).parents(".axisbuilder-layout-column:eq(0)"),d.length||(d=a(this).parents(".axisbuilder-layout-section:eq(0)"))),d.is(".axisbuilder-layout-cell")){var f=d.parents(".axisbuilder-layout-row:eq(0)").find(".axisbuilder-layout-cell").length;if("undefined"==typeof c.new_cell_order[f])return!1;e=!0}d.find("textarea").each(function(){this.innerHTML=this.value});var g=d.clone(),h=d.parents(".axisbuilder-layout-section, .axisbuilder-layout-column");return g.removeClass("ui-draggable ui-droppable").find(".ui-draggable, .ui-droppable").removeClass("ui-draggable ui-droppable"),g.insertAfter(d),e&&b.cell.modify_cell_count(this,-1),(d.is(".axisbuilder-layout-section")||d.is(".axisbuilder-layout-column")||h.length)&&h.length&&(b.textarea.outer(),b.textarea.inner(d)),b.dragdrop.draggable(),b.dragdrop.droppable(),b.textarea.outer(),b.history_snapshot(),!1},trash_element:function(){var c=a(this).parents(".axisbuilder-sortable-element:eq(0)"),d=!1,e=!1,f=200;if(c.length?d=a(this).parents(".axisbuilder-inner-shortcode:eq(0)"):(c=a(this).parents(".axisbuilder-layout-column:eq(0)"),d=a(this).parents(".axisbuilder-layout-section:eq(0)>.axisbuilder-inner-shortcode"),c.length||(c=a(this).parents(".axisbuilder-layout-section:eq(0)"),d=!1)),c.length&&c.is(".axisbuilder-layout-cell")){if(!(d.find(".axisbuilder-layout-cell").length>1))return!1;f=0,e=!0}return c.hide(f,function(){e&&b.cell.modify_cell_count(this,-2),c.remove(),d&&d.length&&b.textarea.inner(d),b.textarea.outer(),""===a(".canvas-data").val()&&b.dragdrop.droppable("","destroy"),b.history_snapshot()}),!1},trash_data:function(){var b=a(".canvas-area").children().length;return a(this).AxisBuilderBackboneModal({title:axisbuilder_admin_meta_boxes_builder.i18n_trash_all_elements_title,message:b>0?axisbuilder_admin_meta_boxes_builder.i18n_trash_all_elements_message:axisbuilder_admin_meta_boxes_builder.i18n_trash_all_elements_atleast,dismiss:b>0?!1:!0,template:"#tmpl-axisbuilder-modal-trash-data"}),!1},resize_layout:function(){for(var d=a(this).is(".axisbuilder-increase")?1:-1,e=a(this).parents(".axisbuilder-layout-column:eq(0)"),f=e.parents(".axisbuilder-layout-section:eq(0)"),g=e.find(".axisbuilder-column-size"),h=e.find('.axisbuilder-inner-shortcode > textarea[data-name="text-shortcode"]'),i=h.val(),j=[],k=c.col_size,l=e.data("width"),m=0;m<k.length;m++)k[m][0]===l&&(j=k[m-d]);return"undefined"!=typeof j&&(i=i.replace(new RegExp("^\\["+l,"g"),"["+j[0]),i=i.replace(new RegExp(l+"\\]","g"),j[0]+"]"),h.val(i),e.removeClass(l).addClass(j[0]),e.attr("data-width",j[0]).data("width",j[0]),g.text(j[1]),b.textarea.outer(),f.length&&(b.textarea.inner(!1,f),b.textarea.outer()),b.history_snapshot()),!1},select_changed:function(){var c=a(this).parents(".axisbuilder-sortable-element:eq(0)");return b.recalc_element(c),!1},recalc_element:function(c){for(var d=[],e=!1,f=c.find("select.axisbuilder-recalculate-shortcode"),g=f.length-1;g>=0;g--)e=a(f[g]),d[e.data("attr")]=e.val();b.send_to_datastorage(d,c)},send_to_datastorage:function(a,c){var d=c.parents(".axisbuilder-layout-column:eq(0)"),e=c.parents(".axisbuilder-layout-section:eq(0)"),f=c.is(".axisbuilder-modal-group-element")?'textarea[data-name="text-shortcode"]:eq(0)':'> .axisbuilder-inner-shortcode >textarea[data-name="text-shortcode"]:eq(0)',g=c.find(f),h=c.data("shortcode-handler"),i="",j={};if("yes"===axisbuilder_admin_meta_boxes_builder.debug_mode&&console.log(a),"string"==typeof a)i=a;else{var k=b.update_builder_html(c,a);i=k.output,j=k.tags}g.val(c.is(".axisbuilder-layout-section")||c.is(".axisbuilder-layout-cell")?g.val().replace(new RegExp("^\\["+h+".*?\\]"),j.open):i),e.length?b.textarea.inner(!1,e):d.length&&b.textarea.inner(!1,d),b.textarea.outer(),b.history_snapshot(),c.trigger("update")},update_builder_html:function(c,d,e){var f,g,h,i;for(f in d)d.hasOwnProperty(f)&&(h=f.replace(/axisbuilderTB-/g,""),f!==h&&(i="undefined"!=typeof d[h]?d[h]+",":"",d[h]=i?i+d[f]:d[f],delete d[f]));for(f in d)if(d.hasOwnProperty(f)&&"content"!==f)if("string"==typeof d[f])d[f]=d[f].replace(/'(.+?)'/g,"‘$1’").replace(/'/g,"’");else if("object"==typeof d[f])for(g in d[f])d[f][g]=d[f][g].replace(/'(.+?)'/g,"‘$1’").replace(/'/g,"’");var j=c.data("shortcode-handler"),k=c.find("[data-update_with]"),l=c.find("[data-update_class_with]"),m="",n="",o="",p="",q="";c.is(".axisbuilder-no-visual-updates")||(l.attr("class",""),k.each(function(){m=a(this),n=m.data("update_with"),o=m.data("update_template")}),l.each(function(){p=a(this),q=p.data("update_class_with").split(",");for(var b=0;b<q.length;b++)"string"==typeof d[q[b]]&&(p.get(0).className+=" axisbuilder-"+q[b]+"-"+d[q[b]])}));var r={},s={};return s.tags=r,s.output=b.shortcode_string(d,j,r,e),s},shortcode_string:function(b,c,d,e){var f,g,h="",i="",j="",k=",",l="\n";if(d||(d={}),"undefined"!=typeof b.content){if("object"==typeof b.content){for(-1!==b.content[0].indexOf("[")&&(k=l),f=0;f<b.content.length;f++)b.content[f]=a.trim(b.content[f]);i=b.content.join(k)}else i=b.content;i=l+i+l,delete b.content}for(g in b)b.hasOwnProperty(g)&&(isNaN(g)?("object"==typeof b[g]&&(b[g]=b[g].join(",")),j+=g+"='"+b[g]+"' "):j+=b[g]+" ");return d.open="["+c+" "+a.trim(j)+"]",h=d.open,(i||"undefined"!=typeof e&&e===!0)&&(""===a.trim(i)&&(i=""),d.close="[/"+c+"]",h+=i+d.close),h+=l+l},history_snapshot:function(b){setTimeout(function(){a(".canvas-area").trigger("axisbuilder_storage_update")},b?b:150)},textarea:{inner:function(c,d){if("undefined"==typeof d&&(d=a(c).parents(".axisbuilder-layout-section:eq(0)")),d.length||(d=a(c).parents(".axisbuilder-layout-column:eq(0)")),!d.length)return!0;var e,f,g,h,i,j,k;if(d.is(".axisbuilder-layout-section")){var l=d.find(".axisbuilder-layout-column-no-cell");for(e=0;e<l.length;e++)b.textarea.inner(!1,a(l[e]));for(l=d.find(".axisbuilder-layout-cell"),e=0;e<l.length;e++)b.textarea.inner(!1,a(l[e]));for(f="",j=d.data("shortcode-handler"),g=d.find('>.axisbuilder-inner-shortcode >textarea[data-name="text-shortcode"]'),h=d.find('>.axisbuilder-inner-shortcode > div textarea[data-name="text-shortcode"]:not( .axisbuilder-layout-column .axisbuilder-sortable-element textarea[data-name="text-shortcode"], .axisbuilder-layout-cell .axisbuilder-layout-column textarea[data-name="text-shortcode"] )'),i=g.val().match(new RegExp("\\["+j+".*?\\]")),e=0;e<h.length;e++)f+=a(h[e]).val();f=i[0]+"\n\n"+f+"[/"+j+"]",g.val(f)}if(d.is(".axisbuilder-layout-cell")){for(f="",k=d.data("width"),g=d.find('>.axisbuilder-inner-shortcode >textarea[data-name="text-shortcode"]'),h=d.find('>.axisbuilder-inner-shortcode > div textarea[data-name="text-shortcode"]:not( .axisbuilder-layout-column-no-cell .axisbuilder-sortable-element textarea[data-name="text-shortcode"] )'),i=g.val().match(new RegExp("\\["+k+".*?\\]")),e=0;e<h.length;e++)f+=a(h[e]).val();f=i[0]+"\n\n"+f+"[/"+k+"]",g.val(f)}if(d.is(".axisbuilder-layout-column:not(.axisbuilder-layout-cell)")){var m=d.is(".axisbuilder-first-column")?" first":"";for(f="",k=d.data("width"),h=d.find('.axisbuilder-sortable-element textarea[data-name="text-shortcode"]'),g=d.find('>.axisbuilder-inner-shortcode >textarea[data-name="text-shortcode"]'),e=0;e<h.length;e++)f+=a(h[e]).val();f="["+k+m+"]\n\n"+f+"[/"+k+"]",g.val(f)}},outer:function(d){if("active"===b.pagebuilder.val()){d||(a(".canvas-area").find(".axisbuilder-layout-section").each(function(){var c=a(this).find(">.axisbuilder-inner-shortcode > div > .axisbuilder-inner-shortcode"),d=a(this).find(".axisbuilder-layout-cell .axisbuilder-layout-column-no-cell > .axisbuilder-inner-shortcode");c.length&&b.textarea.outer(c),d.length&&b.textarea.outer(d)}),d=a(".axisbuilder-data > div > .axisbuilder-inner-shortcode"));for(var e,f,g,h,i,j=0,k="",l=c.col_size,m=d.find('>textarea[data-name="text-shortcode"]'),n=0;n<m.length;n++){if(e=a(m[n]),f=e.val(),g=e.parents(".axisbuilder-layout-column-no-cell:eq(0)"),g.length){h=g.data("width");for(var o in l)h===l[o][0]&&(i=l[o]);j+=i[2],j>1||0===n?(g.is(".axisbuilder-first-column")||(g.addClass("axisbuilder-first-column"),f=f.replace(new RegExp("^\\["+h),"["+h+" first"),e.val(f)),j=i[2]):g.is(".axisbuilder-first-column")&&(g.removeClass("axisbuilder-first-column"),f=f.replace(" first",""),e.val(f))}else j=1;k+=f}"undefined"!=typeof window.tinyMCE&&setTimeout(function(){window.tinyMCE.get("content").setContent(window.switchEditors.wpautop(k),{format:"html"})},500),a(".canvas-data").val(k),a("#content.wp-editor-area").val(k).trigger("axisbuilder_update")}}},dragdrop:{is_scope:function(b){return b||a(".canvas-area").parents(".postbox:eq(0)")},is_droppable:function(a,b){return a.data("dragdrop-level")>b.data("dragdrop-level")},draggable:function(c,d){c=b.dragdrop.is_scope(c),"undefined"==typeof d&&(d=":not(.ui-draggable)");var e={handle:">.menu-item-handle",helper:"clone",scroll:!0,zIndex:2e4,appendTo:"body",cursorAt:{left:20},start:function(b){var c=a(b.target);c.css({opacity:.4}),a(".axisbuilder-hover-active").removeClass("axisbuilder-hover-active"),a(".canvas-area").addClass("axisbuilder-select-target-"+c.data("dragdrop-level"))},stop:function(b){a(b.target).css({opacity:1}),a(".axisbuilder-hover-active").removeClass("axisbuilder-hover-active"),a(".canvas-area").removeClass("axisbuilder-select-target-1 axisbuilder-select-target-2 axisbuilder-select-target-3 axisbuilder-select-target-4")}};c.find(".axisbuilder-drag"+d).draggable(e),c.find(".insert-shortcode").not(".ui-draggable").draggable(a.extend({},e,{handle:!1,cursorAt:{top:33,left:33}}))},droppable:function(c,d){c=b.dragdrop.is_scope(c),"undefined"==typeof d&&(d=":not(.ui-droppable)");var e={greedy:!0,tolerance:"pointer",over:function(c,d){var e=a(this);b.dragdrop.is_droppable(d.helper,e)&&e.addClass("axisbuilder-hover-active")},out:function(){a(this).removeClass("axisbuilder-hover-active")},drop:function(c,d){var e=a(this);if(e.is(".axisbuilder-hover-active")){var f,g,h,i=e.find(">.axisbuilder-drag"),j={},k={},l="after",m=!1,n=[];for(h=0;h<i.length;h++){var o=i.eq(h);if(k=o.offset(),!(k.top<d.offset.top))break;m=o,f=k,n["top_"+k.top]||(g=0,n["top_"+k.top]=[]);var p=o.outerHeight()+k.top;g=g>p?g:p,n["top_"+k.top].push({index:h,top:k.top,left:k.left,height:o.outerHeight(),maxheight:o.outerHeight()+k.top})}if(f&&n["top_"+f.top].length>1&&g-40>d.offset.top){var q=!1;for(h=0;h<n["top_"+f.top].length&&n["top_"+f.top][h].left<d.offset.left;h++)q=n["top_"+f.top][h].index;q===!1&&(l="before",q=n["top_"+f.top][0].index),m=i.eq(q)}if(m===!1&&(m=e,l="prepend"),m[0]===d.draggable[0])return!0;if(d.draggable[0].hash){var r=d.draggable.get(0).hash.replace("#","");j=a(a("#axisbuilder-tmpl-"+r).html()),d.draggable=j}var s=d.draggable.parents(".axisbuilder-drag:last");m[l](d.draggable),s.length&&b.textarea.inner(!1,s);var t="after"===l?m.parents(".axisbuilder-drop"):m;0!==t.data("dragdrop-level")&&(b.textarea.outer(),b.textarea.inner(d.draggable)),b.textarea.outer(),"undefined"!=typeof j&&(a(".canvas-area").removeClass("ui-droppable").droppable("destroy"),b.dragdrop.draggable(),b.dragdrop.droppable()),b.history_snapshot()}}};"destroy"===d&&(c.find(".axisbuilder-drop").droppable("destroy"),d=""),c.find(".axisbuilder-drop"+d).droppable(e)}},cell:{add_cell:function(){return b.cell.modify_cell_count(this,0),!1},set_cell_size:function(){var b,d=a(this).parents(".axisbuilder-layout-row:eq(0)"),e=d.find(".axisbuilder-layout-cell"),f=c.cell_size,g=c.cell_size_variations[e.length],h="";if(g)for(var i in g){var j="",k="";for(var l in g[i]){for(var m in f)f[m][0]===g[i][l]&&(k=f[m][1]);j+='<span class="axisbuilder-modal-label '+g[i][l]+'">'+k+"</span>"}h+='<div class="axisbuilder-layout-row-modal"><label class="axisbuilder-layout-row-modal-label"><input type="radio" id="add_cell_size_'+i+'" name="add_cell_size" value="'+i+'" /><span class="axisbuilder-layout-row-inner-label">'+j+"</span></label></div>"}else b=!0,h+=axisbuilder_admin_meta_boxes_builder.i18n_no_layout+"<br />",h+=1===e.length?axisbuilder_admin_meta_boxes_builder.i18n_add_one_cell:axisbuilder_admin_meta_boxes_builder.i18n_remove_one_cell;return a(this).AxisBuilderBackboneModal({title:axisbuilder_admin_meta_boxes_builder.i18n_select_cell_layout,message:h,dismiss:b,template:"#tmpl-axisbuilder-modal-cell-size"}),!1},modify_cell_count:function(d,e){var f=a(d).parents(".axisbuilder-layout-row:eq(0)"),g=f.find(".axisbuilder-layout-cell"),h=g.length+e,i=c.new_cell_order[h];"undefined"!=typeof i&&(h!==g.length?b.cell.change_multiple_cell_size(g,i):(b.cell.change_multiple_cell_size(g,i),b.cell.insert_cell(f,i),b.dragdrop.droppable()),b.textarea.inner(!1,f),b.textarea.outer(),b.history_snapshot())},insert_cell:function(b,c){var d=b.find("> .axisbuilder-inner-shortcode"),e=c[0].replace("ab_cell_","ab_shortcode_cells_").replace("_one_full",""),f=a(a("#axisbuilder-tmpl-"+e).html());d.append(f)},change_multiple_cell_size:function(d,e,f){var g="",h=e,i=c.cell_size;d.each(function(c){if(f){g=e[c];for(var d in i)g===i[d][0]&&(h=i[d])}b.cell.change_single_cell_size(a(this),h)})},change_single_cell_size:function(a,b){var c=a.data("width"),d=a.find("> .axisbuilder-sorthandle > .axisbuilder-column-size"),e=a.find('> .axisbuilder-inner-shortcode > textarea[data-name="text-shortcode"]'),f=e.val();f=f.replace(new RegExp("^\\["+c,"g"),"["+b[0]),f=f.replace(new RegExp(c+"\\]","g"),b[0]+"]"),e.val(f),a.removeClass(c).addClass(b[0]),a.attr("data-width",b[0]).data("width",b[0]),a.attr("data-shortcode-handler",b[0]).data("shortcode-handler",b[0]),a.attr("data-shortcode-allowed",b[0]).data("shortcode-allowed",b[0]),d.text(b[1])}},backbone:{init:function(b,c){"#tmpl-axisbuilder-modal-edit-element"===c&&a("body").trigger("axisbuilder-enhanced-select-init")},response:function(a,c,d){"#tmpl-axisbuilder-modal-trash-data"===c&&b.backbone.trash_data(),"#tmpl-axisbuilder-modal-cell-size"===c&&b.backbone.cell_size(d.add_cell_size),"#tmpl-axisbuilder-modal-edit-element"===c&&b.backbone.edit_element()},trash_data:function(){a(".canvas-area").empty(),b.textarea.outer()},cell_size:function(d){var e=a("a.axisbuilder-cell-set").parents(".axisbuilder-layout-row:eq(0)"),f=e.find(".axisbuilder-layout-cell"),g=c.cell_size_variations[f.length];d&&(b.cell.change_multiple_cell_size(f,g[d],!0),b.textarea.inner(!1,e),b.textarea.outer(),b.history_snapshot())},edit_element:function(){}},undo_redo:{init:function(){"undefined"!=typeof Storage&&(this.key=this.add_key(),this.storage=this.get_key()||[],this.maximum=this.storage.length-1,this.temporary=this.get_key(this.key+"temp"),("undefined"==typeof this.temporary||null===this.temporary)&&(this.temporary=this.maximum),this.clear_storage())},add_key:function(){var a="axisbuilder"+axisbuilder_admin_meta_boxes_builder.theme_name+axisbuilder_admin_meta_boxes_builder.theme_version+axisbuilder_admin_meta_boxes_builder.post_id+axisbuilder_admin_meta_boxes_builder.plugin_version;return a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()},get_key:function(a){var c=a||b.undo_redo.key;return JSON.parse(sessionStorage.getItem(c))},set_key:function(c,d){var e=c||b.undo_redo.key,f=d||JSON.stringify(b.undo_redo.storage);try{sessionStorage.setItem(e,f)}catch(g){b.undo_redo.clear_storage(),a(".undo-data, .redo-data").addClass("inactive-history"),console.log("Storage Limit reached. Your Browser does not offer enough session storage to save more steps for the undo/redo history.",g)}},clear_storage:function(){sessionStorage.removeItem(b.undo_redo.key),sessionStorage.removeItem(b.undo_redo.key+"temp"),b.undo_redo.storage=[],b.undo_redo.temporary=null},undo_data:function(){var a=b.undo_redo;return a.temporary-1>=0&&(a.temporary--,a.canvas_update(a.storage[a.temporary])),!1},redo_data:function(){var a=b.undo_redo;return a.temporary+1<=a.maximum&&(a.temporary++,a.canvas_update(a.storage[a.temporary])),!1},keyboard_actions:function(a){var c=a.keyCode||a.which,d=a.ctrlKey||a.metaKey,e=b.undo_redo;90===c&&(d||d&&a.shiftKey)&&(setTimeout(function(){e.undo_data()},100),a.stopImmediatePropagation()),89===c&&(d||d&&a.shiftKey)&&(setTimeout(function(){e.redo_data()},100),a.stopImmediatePropagation())},canvas_update:function(c){var d=b.undo_redo;"undefined"!=typeof window.tinyMCE&&window.tinyMCE.get("content").setContent(window.switchEditors.wpautop(c[0]),{format:"html"}),a(".canvas-data").val(c[0]),a(".canvas-area").html(c[1]),sessionStorage.setItem(d.key+"temp",d.temporary),d.temporary<=0?a(".undo-data").addClass("inactive-history"):a(".undo-data").removeClass("inactive-history"),d.temporary+1>d.maximum?a(".redo-data").addClass("inactive-history"):a(".redo-data").removeClass("inactive-history"),a(".canvas-area").trigger("axisbuilder_history_update")},storage_update:function(){var c=b.undo_redo;a(".canvas-area").find("textarea").each(function(){this.innerHTML=this.value}),c.storage=c.storage||c.get_key()||[],c.temporary=c.temporary||c.get_key(c.key+"temp"),("undefined"==typeof c.temporary||null===c.temporary)&&(c.temporary=c.storage.length-1);var d=[a(".canvas-data").val(),a(".canvas-area").html().replace(/modal-animation/g,"")],e=c.storage[c.temporary];("undefined"==typeof e||e[0]!==d[0])&&(c.temporary++,c.storage=c.storage.slice(0,c.temporary),c.storage.push(d),c.storage.length>40&&c.storage.shift(),b.undo_redo.set_key()),c.maximum=c.storage.length-1,1===c.storage.length||0===c.temporary?a(".undo-data").addClass("inactive-history"):a(".undo-data").removeClass("inactive-history"),c.storage.length-1===c.temporary?a(".redo-data").addClass("inactive-history"):a(".redo-data").removeClass("inactive-history")},history_update:function(){b.dragdrop.draggable("",""),b.dragdrop.droppable("","")}},stupidtable:{init:function(){a(".axisbuilder_editor").stupidtable().on("aftertablesort",this.add_arrows)},add_arrows:function(b,c){var d=a(this).find("th"),e="asc"===c.direction?"&uarr;":"&darr;",f=c.column;f>1&&(f-=1),d.find(".axisbuilder-arrow").remove(),d.eq(f).append('<span class="axisbuilder-arrow">'+e+"</span>")}}},c={col_size:[["ab_one_full","1/1",1],["ab_four_fifth","4/5",.8],["ab_three_fourth","3/4",.75],["ab_two_third","2/3",.66],["ab_three_fifth","3/5",.6],["ab_one_half","1/2",.5],["ab_two_fifth","2/5",.4],["ab_one_third","1/3",.33],["ab_one_fourth","1/4",.25],["ab_one_fifth","1/5",.2]],cell_size:[["ab_cell_one_full","1/1",1],["ab_cell_four_fifth","4/5",.8],["ab_cell_three_fourth","3/4",.75],["ab_cell_two_third","2/3",.66],["ab_cell_three_fifth","3/5",.6],["ab_cell_one_half","1/2",.5],["ab_cell_two_fifth","2/5",.4],["ab_cell_one_third","1/3",.33],["ab_cell_one_fourth","1/4",.25],["ab_cell_one_fifth","1/5",.2]],new_cell_order:[["ab_cell_one_full","1/1"],["ab_cell_one_half","1/2"],["ab_cell_one_third","1/3"],["ab_cell_one_fourth","1/4"],["ab_cell_one_fifth","1/5"]],cell_size_variations:{4:{1:["ab_cell_one_fourth","ab_cell_one_fourth","ab_cell_one_fourth","ab_cell_one_fourth"],2:["ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_two_fifth"],3:["ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_two_fifth","ab_cell_one_fifth"],4:["ab_cell_one_fifth","ab_cell_two_fifth","ab_cell_one_fifth","ab_cell_one_fifth"],5:["ab_cell_two_fifth","ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_one_fifth"]},3:{1:["ab_cell_one_third","ab_cell_one_third","ab_cell_one_third"],2:["ab_cell_one_fourth","ab_cell_one_fourth","ab_cell_one_half"],3:["ab_cell_one_fourth","ab_cell_one_half","ab_cell_one_fourth"],4:["ab_cell_one_half","ab_cell_one_fourth","ab_cell_one_fourth"],5:["ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_three_fifth"],6:["ab_cell_one_fifth","ab_cell_three_fifth","ab_cell_one_fifth"],7:["ab_cell_three_fifth","ab_cell_one_fifth","ab_cell_one_fifth"],8:["ab_cell_one_fifth","ab_cell_two_fifth","ab_cell_two_fifth"],9:["ab_cell_two_fifth","ab_cell_one_fifth","ab_cell_two_fifth"],10:["ab_cell_two_fifth","ab_cell_two_fifth","ab_cell_one_fifth"]},2:{1:["ab_cell_one_half","ab_cell_one_half"],2:["ab_cell_two_third","ab_cell_one_third"],3:["ab_cell_one_third","ab_cell_two_third"],4:["ab_cell_one_fourth","ab_cell_three_fourth"],5:["ab_cell_three_fourth","ab_cell_one_fourth"],6:["ab_cell_one_fifth","ab_cell_four_fifth"],7:["ab_cell_four_fifth","ab_cell_one_fifth"],8:["ab_cell_two_fifth","ab_cell_three_fifth"],9:["ab_cell_three_fifth","ab_cell_two_fifth"]}}};b.init()});