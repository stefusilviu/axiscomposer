var AC_Icon_Fonts=AC_Icon_Fonts||{};!function(a,b,c){"use strict";AC_Icon_Fonts.AppView=b.View.extend({el:"#axiscomposer-iconfonts",events:{"click .modal-close":"closeButton","click #btn-ok":"addButton"},initialize:function(){c.bindAll(this,"render"),this.render()},render:function(){},addButton:function(b){var c=a(".add-iconfont"),d="";return b.preventDefault(),d?void d.open():(d=wp.media.frames.iconfont_media_frame=wp.media({title:c.data("choose"),button:{text:c.data("update")},library:{type:c.data("mime")},multiple:!1}),d.on("select",function(){var b=d.state().get("selection").first().toJSON();a("#"+c.data("target")).val(b.id).trigger("change"),a(document.body).trigger(c.data("trigger"),[b,c])}),void d.open())},closeButton:function(b){var c=a(".del-iconfont"),d=a("#msg");b.preventDefault();var e={term:c.data("delete"),action:"axiscomposer_delete_iconfont",security:axiscomposer_admin_iconfonts.delete_custom_iconfont_nonce};a.ajax({url:axiscomposer_admin_iconfonts.ajax_url,data:e,type:"POST",beforeSend:function(){a(".spinner").css({opacity:0,display:"block",position:"absolute",top:"21px",left:"300px"}).animate({opacity:1})},error:function(){a(".spinner").hide(),d.html('<div class="error"><p>Unable to remove the font because the server didn\'t respond.<br />Please reload the page, then try again</p></div>'),d.show(),setTimeout(function(){d.slideUp()},5e3)},success:function(b){a(".spinner").hide(),b.match(/axiscomposer_iconfont_removed/)?(d.html('<div class="updated"><p>Font icon removed successfully! Reloading the page... </p></div>'),d.show(),setTimeout(function(){d.slideUp(),location.reload()},5e3)):(d.html('<div class="error"><p>Unable to remove the font. Reloading the page... </p></div>'),d.show(),setTimeout(function(){d.slideUp(),location.reload()},5e3))}})}}),a(document).ready(function(){new AC_Icon_Fonts.AppView,a("body").on("insert_iconfont_zip",AC_Icon_Fonts.icon_insert)}),AC_Icon_Fonts.icon_insert=function(b,c){var d=a("#msg");if("zip"!==c.subtype)return a(".spinner").hide(),d.html('<div class="error"><p>Please upload a valid ZIP file.<br />You can create the file on icomoon.io</p></div>'),d.show(),setTimeout(function(){d.slideUp()},5e3),!1;var e={value:c,action:"axiscomposer_add_iconfont",security:axiscomposer_admin_iconfonts.add_custom_iconfont_nonce};a.ajax({url:axiscomposer_admin_iconfonts.ajax_url,data:e,type:"POST",beforeSend:function(){a(".spinner").css({opacity:0,display:"block",position:"absolute",top:"21px",left:"300px"}).animate({opacity:1})},success:function(b){a(".spinner").hide(),b.match(/axiscomposer_iconfont_added/)?(d.html('<div class="updated"><p>Font icon added successfully! Reloading the page... </p></div>'),d.show(),setTimeout(function(){d.slideUp(),location.reload()},5e3)):(d.html('<div class="error"><p>Couldn\'t add the font.<br/>The script returned the following error: '+b+"</p></div>"),d.show(),setTimeout(function(){d.slideUp()},5e3))}})}}(jQuery,Backbone,_);