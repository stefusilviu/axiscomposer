jQuery(function(a){var b;try{b="sessionStorage"in window&&null!==window.sessionStorage,window.sessionStorage.setItem("ac","test"),window.sessionStorage.removeItem("ac")}catch(c){b=!1}var d={pagebuilder:null,init:function(){this.pagebuilder=a("#axiscomposer-pagebuilder").find(":input.pagebuilder-status"),this.storage.init(),this.shortcode.init(),this.stupidtable.init(),a("a.axiscomposer-toggle-editor").click(this.toggle_editor),a("#axiscomposer-pagebuilder").on("click",".insert-shortcode",this.add_element).on("click",".axiscomposer-edit",this.edit_element).on("click","a.axiscomposer-clone",this.clone_element).on("click","a.axiscomposer-trash",this.trash_element).on("click","a.undo-data",this.storage.undo_data).on("click","a.redo-data",this.storage.redo_data).on("click","a.trash-data",this.trash_data).on("click","a.ac-change-column-size:not(.ac-change-cell-size)",this.resize_layout).on("click","a.axiscomposer-cell-add",this.cell.add_cell).on("click","a.axiscomposer-cell-set",this.cell.set_cell_size).on("change","select.ac-recalc-shortcode",this.select_changed),a(document.body).on("keydown storage",this.storage.keyboard_actions).on("ac_storage_snapshot",this.storage.snapshot).on("ac_dragdrop_items_loaded",this.dragdrop.init).on("ac_backbone_modal_loaded",this.backbone.init).on("ac_backbone_modal_response",this.backbone.response)},tiptip:function(){a("#tiptip_holder").removeAttr("style"),a("#tiptip_arrow").removeAttr("style"),a(".tips, .help_tip, .axiscomposer-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},block:function(){a("#axiscomposer-pagebuilder").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){a("#axiscomposer-pagebuilder").unblock()},tinyMCE:function(b){if("undefined"!=typeof window.tinyMCE){var c=window.tinyMCE.get("content");c&&c.setContent(window.switchEditors.wpautop(b),{format:"html"})}a("#content.wp-editor-area").val(b)},toggle_editor:function(b){b.preventDefault();var c=a(this);c.is(".disabled")||("active"!==d.pagebuilder.val()?(a("#content-html").trigger("click"),a("#axiscomposer-pagebuilder").removeClass("ac-hidden"),a("#postdivrich").parent().addClass("ac-hidden-editor"),c.removeClass("button-primary").addClass("button-secondary").text(a(this).data("editor")),d.pagebuilder.val("active"),setTimeout(function(){a("#content-tmce").trigger("click"),d.shortcode.init()},10)):(a("#axiscomposer-pagebuilder").find(".canvas-area").empty(),a("#axiscomposer-pagebuilder").addClass("ac-hidden"),a("#postdivrich").parent().removeClass("ac-hidden-editor"),c.addClass("button-primary").removeClass("button-secondary").text(a(this).data("builder")),d.pagebuilder.val("inactive"),a(document.body).trigger("ac-switch-editor-modes"),"yes"!==axiscomposer_admin_meta_boxes_pagebuilder.debug_mode&&-1!==a(".canvas-data").val().indexOf("[")&&d.tinyMCE("")))},add_element:function(){if(!a(this).is(".disabled-shortcode")){var b=this.hash.replace("#",""),c=a("#tmpl-axiscomposer-shortcode-"+b),e="instant-insert";return c.length&&"instant-insert"===e&&(a(".canvas-area").append(c.html()),d.shortcode.outer_textarea(),d.storage.history_snapshot(),a(document.body).trigger("ac_dragdrop_items_loaded")),!1}},edit_element:function(){var b=a(this).parents(".ac-sortable-element:eq(0)");return b.length||(b=a(this).parents(".ac-layout-cell:eq(0)"),b.length||(b=a(this).parents(".ac-layout-section:eq(0)"))),window.ac_shortcode=b,a(this).ACBackboneModal({template:"axiscomposer-modal-edit-element",variable:{title:b.data("modal-title")}}),!1},clone_element:function(){var b=a(this).parents(".ac-sortable-element:eq(0)"),c=!1;if(b.length||(b=a(this).parents(".ac-layout-column:eq(0)"),b.length||(b=a(this).parents(".ac-layout-section:eq(0)"))),b.length&&b.is(".ac-layout-cell")){var f=b.parents(".ac-layout-row:eq(0)").find(".ac-layout-cell").length;if("undefined"==typeof e.new_cell_order[f])return!1;c=!0}b.find("textarea").each(function(){this.innerHTML=this.value}),b.clone().insertAfter(b),c&&d.cell.modify_cell_count(this,-1);var g=b.parents(".ac-layout-section, .ac-layout-column");return(b.is(".ac-layout-section")||b.is(".ac-layout-column")||g.length)&&g.length&&(d.shortcode.outer_textarea(),d.shortcode.inner_textarea(b)),d.shortcode.outer_textarea(),d.storage.history_snapshot(),a(document.body).trigger("ac_dragdrop_items_loaded"),!1},trash_element:function(){var b=a(this).parents(".ac-sortable-element:eq(0)"),c=!1,e=!1,f=200;if(b.length?c=a(this).parents(".ac-inner-shortcode:eq(0)"):(b=a(this).parents(".ac-layout-column:eq(0)"),c=a(this).parents(".ac-layout-section:eq(0) > .ac-inner-shortcode"),b.length||(b=a(this).parents(".ac-layout-section:eq(0)"),c=!1)),b.length&&b.is(".ac-layout-cell")){if(!(c.find(".ac-layout-cell").length>1))return!1;f=0,e=!0}return b.hide(f,function(){e&&d.cell.modify_cell_count(this,-2),b.remove(),c&&c.length&&d.shortcode.inner_textarea(c),d.shortcode.outer_textarea(),d.storage.history_snapshot(),""===a(".canvas-data").val()&&(a(".ac-drop").droppable("destroy"),a(document.body).trigger("ac_dragdrop_items_loaded"))}),!1},trash_data:function(){var b=a(".canvas-area").children().length;return 0===b&&(d.storage.remove_storage(),d.storage.history_snapshot()),a(this).ACBackboneModal({template:"axiscomposer-modal-trash-data",variable:{title:axiscomposer_admin_meta_boxes_pagebuilder.i18n_trash_elements_title,message:b>0?axiscomposer_admin_meta_boxes_pagebuilder.i18n_trash_elements_notice:axiscomposer_admin_meta_boxes_pagebuilder.i18n_trash_elements_least,dismiss:b>0?!1:!0}}),!1},resize_layout:function(){for(var b=a(this).is(".ac-increase")?1:-1,c=a(this).parents(".ac-layout-column:eq(0)"),f=c.parents(".ac-layout-section:eq(0)"),g=c.find(".ac-column-size"),h=c.find('.ac-inner-shortcode > textarea[data-name="text-shortcode"]'),i=[],j=e.col_size,k=c.data("width"),l=0;l<j.length;l++)j[l][0]===k&&(i=j[l-b]);return"undefined"!=typeof i&&(h.val(d.shortcode.replace_tag(k,h.val(),i[0])),c.removeClass(k).addClass(i[0]),c.attr("data-width",i[0]).data("width",i[0]),g.text(i[1]),d.shortcode.outer_textarea(),f.length&&(d.shortcode.inner_textarea(!1,f),d.shortcode.outer_textarea()),d.storage.history_snapshot()),!1},select_changed:function(){var b=a(this).parents(".ac-sortable-element:eq(0)");return d.recalc_element(b),!1},recalc_element:function(b){for(var c={},e=b.find("select.ac-recalc-shortcode"),f=e.length-1;f>=0;f--){var g=a(e[f]);c[g.data("attr")]=g.val()}d.send_to_datastorage(c,b)},send_to_datastorage:function(b,c){var e=c.parents(".ac-layout-column:eq(0)"),f=c.parents(".ac-layout-section:eq(0)"),g=c.find('> .ac-inner-shortcode > textarea[data-name="text-shortcode"]:eq(0)'),h=c.data("shortcode-handler"),i="closed",j="";if((c.is(".ac-layout-section")||c.is(".ac-layout-column"))&&(i="single"),j="string"==typeof b?b:d.update_builder_html(b,h,i,c),"single"===i){var k=new RegExp("^\\["+h+".*?\\]");g.val(g.val().replace(k,a.trim(j)))}else g.val(j);f.length?d.shortcode.inner_textarea(!1,f):e.length&&d.shortcode.inner_textarea(!1,e),d.shortcode.outer_textarea(),d.storage.history_snapshot(),c.trigger("update")},update_builder_html:function(b,c,e,f){var g,h,i;for(g in b)b.hasOwnProperty(g)&&(h=g.replace(/axiscomposer_/g,""),g!==h&&(i="undefined"!=typeof b[h]?b[h]+",":"",b[h]=i?i+b[g]:b[g],delete b[g]));for(g in b)if(b.hasOwnProperty(g)&&"content"!==g)if("string"==typeof b[g])b[g]=b[g].replace(/'(.+?)'/g,"‘$1’").replace(/'/g,"’");else if("object"==typeof b[g])for(var j in b[g])b[g][j]=b[g][j].replace(/'(.+?)'/g,"‘$1’").replace(/'/g,"’");var k=f.find("[data-update_with]"),l=f.find("[data-update_class_with]"),m="",n="",o="",p="",q="";return f.is(".ac-no-visual-updates")||(l.attr("class",""),k.each(function(){m=a(this),n=m.data("update_with"),o=m.data("update_template")}),l.each(function(){p=a(this),q=p.data("update_class_with").split(",");for(var c=0;c<q.length;c++)"string"==typeof b[q[c]]&&(p.get(0).className+=" axiscomposer-"+q[c]+"-"+b[q[c]])})),d.shortcode.create_string(b,c,e)},dragdrop:{init:function(){d.dragdrop.disable(),d.dragdrop.draggable(),d.dragdrop.droppable()},disable:function(){a("#axiscomposer-pagebuilder").find(".ui-draggable, .ui-droppable").removeClass("ui-draggable ui-droppable")},is_droppable:function(a,b){return a.data("dragdrop-level")>b.data("dragdrop-level")},draggable:function(){var b={handle:">.menu-item-handle",helper:"clone",scroll:!0,zIndex:2e4,appendTo:"body",cursorAt:{left:20},start:function(b){var c=a(b.target);c.css({opacity:.4}),a(".ac-hover-active").removeClass("ac-hover-active"),a(".canvas-area").addClass("ac-select-target-"+c.data("dragdrop-level"))},stop:function(b){a(b.target).css({opacity:1}),a(".ac-hover-active").removeClass("ac-hover-active"),a(".canvas-area").removeClass("ac-select-target-1 ac-select-target-2 ac-select-target-3 ac-select-target-4")}};a("#axiscomposer-pagebuilder").find(".ac-drag").not(".ui-draggable").draggable(b),a("#axiscomposer-pagebuilder").find(".insert-shortcode").not(".ui-draggable, .disabled-shortcode").draggable(a.extend({},b,{handle:!1,cursorAt:{top:33,left:33}}))},droppable:function(){var b={greedy:!0,tolerance:"pointer",over:function(b,c){var e=a(this);d.dragdrop.is_droppable(c.helper,e)&&e.addClass("ac-hover-active")},out:function(){a(this).removeClass("ac-hover-active")},drop:function(b,c){var e=a(this);if(e.is(".ac-hover-active")){var f,g,h,i=e.find(">.ac-drag"),j={},k={},l="after",m=!1,n=[];for(h=0;h<i.length;h++){var o=i.eq(h);if(k=o.offset(),!(k.top<c.offset.top))break;m=o,f=k,n["top_"+k.top]||(g=0,n["top_"+k.top]=[]);var p=o.outerHeight()+k.top;g=g>p?g:p,n["top_"+k.top].push({index:h,top:k.top,left:k.left,height:o.outerHeight(),maxheight:o.outerHeight()+k.top})}if(f&&n["top_"+f.top].length>1&&g-40>c.offset.top){var q=!1;for(h=0;h<n["top_"+f.top].length&&n["top_"+f.top][h].left<c.offset.left;h++)q=n["top_"+f.top][h].index;q===!1&&(l="before",q=n["top_"+f.top][0].index),m=i.eq(q)}if(m===!1&&(m=e,l="prepend"),m[0]===c.draggable[0])return!0;if(c.draggable[0].hash){var r=c.draggable.get(0).hash.replace("#","");j=a.parseHTML(a("#tmpl-axiscomposer-shortcode-"+r).html()),c.draggable=j}var s=a(c.draggable).parents(".ac-drag:last");m[l](c.draggable),s.length&&d.shortcode.inner_textarea(!1,s);var t="after"===l?m.parents(".ac-drop"):m;0!==t.data("dragdrop-level")&&(d.shortcode.outer_textarea(),d.shortcode.inner_textarea(c.draggable)),d.shortcode.outer_textarea(),"undefined"!=typeof j&&a(document.body).trigger("ac_dragdrop_items_loaded"),d.storage.history_snapshot()}}};a("#axiscomposer-pagebuilder").find(".ac-drop").not(".ui-droppable").droppable(b)}},cell:{add_cell:function(){return d.cell.modify_cell_count(this,0),!1},set_cell_size:function(){var b=a(this).parents(".ac-layout-row:eq(0)"),c=b.find(".ac-layout-cell"),d=e.cell_size,f=e.cell_size_variations[c.length],g="";if(f)for(var h in f){var i="",j="";for(var k in f[h]){for(var l in d)d[l][0]===f[h][k]&&(j=d[l][1]);i+='<span class="ac-modal-label '+f[h][k]+'">'+j+"</span>"}g+='<div class="ac-layout-row-modal"><label class="ac-layout-row-modal-label"><input type="radio" id="add_cell_size_'+h+'" name="add_cell_size" value="'+h+'" /><span class="ac-layout-row-inner-label">'+i+"</span></label></div>"}else g+=axiscomposer_admin_meta_boxes_pagebuilder.i18n_no_layout+"<br />",g+=1===c.length?'<mark class="yes">'+axiscomposer_admin_meta_boxes_pagebuilder.i18n_add_one_cell+"</mark>":'<mark class="no">'+axiscomposer_admin_meta_boxes_pagebuilder.i18n_remove_one_cell+"</mark>";return a(this).ACBackboneModal({template:"axiscomposer-modal-cell-size",variable:{title:axiscomposer_admin_meta_boxes_pagebuilder.i18n_select_cell_layout,message:g,dismiss:f?!1:!0}}),!1},modify_cell_count:function(b,c){var f=a(b).parents(".ac-layout-row:eq(0)"),g=f.find(".ac-layout-cell"),h=g.length+c,i=e.new_cell_order[h];if("undefined"!=typeof i){if(d.cell.change_multiple_cell_size(g,i),g.length===h){var j=a("#tmpl-axiscomposer-shortcode-"+i[0].replace("_one_full",""));j.length&&(f.find("> .ac-inner-shortcode").append(j.html()),a(document.body).trigger("ac_dragdrop_items_loaded"))}d.shortcode.inner_textarea(!1,f),d.shortcode.outer_textarea(),d.storage.history_snapshot()}},change_multiple_cell_size:function(b,c,f){var g="",h=c,i=e.cell_size;b.each(function(b){if(f){g=c[b];for(var e in i)g===i[e][0]&&(h=i[e])}d.cell.change_single_cell_size(a(this),h)})},change_single_cell_size:function(a,b){var c=a.data("width"),e=a.find("> .ac-sorthandle > .ac-column-size"),f=a.find('> .ac-inner-shortcode > textarea[data-name="text-shortcode"]');f.val(d.shortcode.replace_tag(c,f.val(),b[0])),a.removeClass(c).addClass(b[0]),a.attr("data-width",b[0]).data("width",b[0]),a.attr("data-shortcode-handler",b[0]).data("shortcode-handler",b[0]),a.attr("data-shortcode-allowed",b[0]).data("shortcode-allowed",b[0]),e.text(b[1])}},backbone:{init:function(a,b){"axiscomposer-modal-edit-element"===b&&d.backbone.init_edit_element()},block:function(){a(".ac-enhanced-settings").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},enable:function(){a(".ac-backbone-modal-content").find("button").removeAttr("disabled")},disable:function(){a(".ac-backbone-modal-content").find("button").attr("disabled","disabled")},dismiss:function(){a(".ac-backbone-modal-content").find("p").append(axiscomposer_admin_meta_boxes_pagebuilder.i18n_backbone_loading_falied),a(".ac-backbone-modal-footer .inner").find("button").removeAttr("id").removeClass("button-primary").addClass("button-secondary modal-close").text(axiscomposer_admin_meta_boxes_pagebuilder.i18n_backbone_dismiss_button)},init_edit_element:function(){var b=window.ac_shortcode;d.backbone.block(),d.backbone.disable();var c={fetch:!0,params:{extract:!0,shortcode:b.find('> .ac-inner-shortcode > textarea[data-name="text-shortcode"]:eq(0)').val()},action:"axiscomposer_"+b.data("modal-action"),security:axiscomposer_admin_meta_boxes_pagebuilder.modal_item_nonce};a.ajax({url:axiscomposer_admin_meta_boxes_pagebuilder.ajax_url,data:c,type:"POST",success:function(b){b&&b.fragments&&(a.each(b.fragments,function(b,c){a(b).replaceWith(c),a(b).unblock()}),a(document.body).trigger("ac-enhanced-modal-elements-init")),d.tiptip(),d.backbone.enable(),d.stupidtable.init()}})},response:function(a,b,c){"axiscomposer-modal-trash-data"===b&&d.backbone.trash_data(),"axiscomposer-modal-cell-size"===b&&d.backbone.cell_size(c.add_cell_size),"axiscomposer-modal-edit-element"===b&&d.backbone.edit_element(c)},trash_data:function(){a(".canvas-area").empty(),d.shortcode.outer_textarea(),d.storage.remove_storage(),d.storage.history_snapshot()},cell_size:function(b){var c=a("a.axiscomposer-cell-set").parents(".ac-layout-row:eq(0)"),f=c.find(".ac-layout-cell"),g=e.cell_size_variations[f.length];b&&(d.cell.change_multiple_cell_size(f,g[b],!0),d.shortcode.inner_textarea(!1,c),d.shortcode.outer_textarea(),d.storage.history_snapshot())},edit_element:function(a){var b=window.ac_shortcode;d.send_to_datastorage(a,b)}},storage:{current_step:null,maximum_step:null,init:function(){this.tab_storage(),this.remove_storage()},snapshot:function(){var b,c=d.storage;if(a(".canvas-area").find("textarea").each(function(){this.innerHTML=this.value}),b=c.get_storage("history")){c.current_step=b.length-1;var e=b[c.current_step],f=[a(".canvas-data").val(),a(".canvas-area").html().replace(/modal-animation/g,"")];if(void 0===e||e[0]!==f[0]){c.current_step++,b=b.slice(0,c.current_step),b.push(f),b.length>40&&(b.shift(),c.current_step--);try{c.set_storage("history",b)}catch(g){d.storage.remove_storage(),a(".undo-data, .redo-data").addClass("inactive-history")}}c.maximum_step=b.length-1}c.buttons_state()},undo_data:function(a){a.preventDefault();var b=d.storage;b.current_step-1>=0&&(b.current_step--,b.canvas_update())},redo_data:function(a){a.preventDefault();var b=d.storage;b.current_step+1<=b.maximum_step&&(b.current_step++,b.canvas_update())},canvas_update:function(){var b,c=d.storage;(b=c.get_storage("history"))&&(a(".canvas-data").val(b[c.current_step][0]),a(".canvas-area").html(b[c.current_step][1]),d.tinyMCE(b[c.current_step][0])),c.buttons_state(),a(document.body).trigger("ac_dragdrop_items_loaded")},buttons_state:function(){var b=d.storage;b.current_step<=0?a(".undo-data").addClass("inactive-history"):a(".undo-data").removeClass("inactive-history"),b.current_step===b.maximum_step?a(".redo-data").addClass("inactive-history"):a(".redo-data").removeClass("inactive-history")},tab_storage:function(){var b,c=d.storage;a("ul.pagebuilder_data_tabs li").click(function(b){b.preventDefault(),c.set_storage("tab",a(this).index())}),a("div.panel-wrap").filter(".pagebuilder_data").each(function(){(b=c.get_storage("tab"))&&(null===b||void 0===b||0===b.length)&&(b=0),a(this).find("ul.pagebuilder_data_tabs li").eq(b).find("a").click()})},get_storage:function(a){var c=!1,d=axiscomposer_admin_meta_boxes_pagebuilder.post_id;return b&&d&&(c=sessionStorage.getItem("ac-storage-"+d+"-"+a),c=c?JSON.parse(c):[]),c},set_storage:function(a,c){var d,e=axiscomposer_admin_meta_boxes_pagebuilder.post_id;return b&&e?(d="ac-storage-"+e+"-"+a,sessionStorage.setItem(d,JSON.stringify(c)),null!==sessionStorage.getItem(d)):!1},remove_storage:function(){var a=axiscomposer_admin_meta_boxes_pagebuilder.post_id;b&&a&&sessionStorage.removeItem("ac-storage-"+a+"-history")},history_snapshot:function(){setTimeout(function(){a(document.body).trigger("ac_storage_snapshot")},150)},keyboard_actions:function(a){var b=a.keyCode||a.which,c=a.ctrlKey||a.metaKey;90!==b||!c||a.shiftKey||a.altKey||d.storage.undo_data(a),89!==b||!c||a.shiftKey||a.altKey||d.storage.redo_data(a)}},shortcode:{init:function(){this.load_shortcode()},load_shortcode:function(b){if("active"===d.pagebuilder.val()){"undefined"==typeof b&&(b=a(".canvas-data").val(),-1===b.indexOf("[")&&(b=a("#content.wp-editor-area").val(),"undefined"!=typeof window.tinyMCE&&(b=window.switchEditors._wp_Nop(b)),a(".canvas-data").val(b)));var c={text:b,action:"axiscomposer_shortcodes_to_interface"};d.block(),a.ajax({url:axiscomposer_admin_meta_boxes_pagebuilder.ajax_url,data:c,type:"POST",success:function(b){b&&(a(".canvas-area").empty(),a(".canvas-area").append(b)),a("#content-tmce").trigger("click"),d.storage.history_snapshot(),a(document.body).trigger("ac_dragdrop_items_loaded"),d.tiptip(),d.unblock(),d.stupidtable.init()}})}},replace_tag:function(a,b,c){return b=b.replace(new RegExp("^\\["+a,"g"),"["+c),b=b.replace(new RegExp(a+"\\]","g"),c+"]")},create_string:function(b,c,d){var e="",f=",",g="\n";if("undefined"!=typeof b.content){if("object"==typeof b.content){-1!==b.content[0].indexOf("[")&&(f=g);for(var h=0;h<b.content.length;h++)b.content[h]=a.trim(b.content[h]);e=b.content.join(f)}else e=b.content;e=g+e+g,delete b.content}var i=wp.shortcode.string({tag:c,attrs:b,type:d,content:e});return i+g+g},inner_textarea:function(b,c){if("undefined"==typeof c&&(c=a(b).parents(".ac-layout-section:eq(0)")),c.length||(c=a(b).parents(".ac-layout-column:eq(0)")),!c.length)return!0;var e,f,g,h,i,j,k;if(c.is(".ac-layout-section")){var l=c.find(".ac-layout-column-no-cell");for(e=0;e<l.length;e++)d.shortcode.inner_textarea(!1,a(l[e]));for(l=c.find(".ac-layout-cell"),e=0;e<l.length;e++)d.shortcode.inner_textarea(!1,a(l[e]));for(f="",j=c.data("shortcode-handler"),g=c.find('> .ac-inner-shortcode > textarea[data-name="text-shortcode"]'),h=c.find('> .ac-inner-shortcode > div textarea[data-name="text-shortcode"]:not( .ac-layout-column .ac-sortable-element textarea[data-name="text-shortcode"], .ac-layout-cell .ac-layout-column textarea[data-name="text-shortcode"] )'),i=g.val().match(new RegExp("\\["+j+".*?\\]")),e=0;e<h.length;e++)f+=a(h[e]).val();f=i[0]+"\n\n"+f+"[/"+j+"]",g.val(f)}if(c.is(".ac-layout-cell")){for(f="",k=c.data("width"),g=c.find('> .ac-inner-shortcode > textarea[data-name="text-shortcode"]'),h=c.find('> .ac-inner-shortcode > div textarea[data-name="text-shortcode"]:not( .ac-layout-column-no-cell .ac-sortable-element textarea[data-name="text-shortcode"] )'),i=g.val().match(new RegExp("\\["+k+".*?\\]")),e=0;e<h.length;e++)f+=a(h[e]).val();f=i[0]+"\n\n"+f+"[/"+k+"]",g.val(f)}if(c.is(".ac-layout-column:not(.ac-layout-cell)")){var m=c.is(".ac-first-column")?" first":"";for(f="",k=c.data("width"),h=c.find('.ac-sortable-element textarea[data-name="text-shortcode"]'),g=c.find('> .ac-inner-shortcode > textarea[data-name="text-shortcode"]'),e=0;e<h.length;e++)f+=a(h[e]).val();f="["+k+m+"]\n\n"+f+"[/"+k+"]",g.val(f)}},outer_textarea:function(b){if("active"===d.pagebuilder.val()){b||(a(".canvas-area").find(".ac-layout-section").each(function(){var b=a(this).find("> .ac-inner-shortcode > div > .ac-inner-shortcode"),c=a(this).find(".ac-layout-cell .ac-layout-column-no-cell > .ac-inner-shortcode");b.length&&d.shortcode.outer_textarea(b),c.length&&d.shortcode.outer_textarea(c)}),b=a(".ac-data > div > .ac-inner-shortcode"));for(var c,f,g,h,i,j="",k=0,l=e.col_size,m=b.find('> textarea[data-name="text-shortcode"]'),n=0;n<m.length;n++){if(c=a(m[n]),f=c.val(),g=c.parents(".ac-layout-column-no-cell:eq(0)"),g.length){h=g.data("width");for(var o in l)h===l[o][0]&&(i=l[o]);k+=i[2],k>1||0===n?(g.is(".ac-first-column")||(g.addClass("ac-first-column"),f=f.replace(new RegExp("^\\["+h),"["+h+" first"),c.val(f)),k=i[2]):g.is(".ac-first-column")&&(g.removeClass("ac-first-column"),f=f.replace(" first",""),c.val(f))}else k=1;j+=f}a(".canvas-data").val(j);var p=!1;clearTimeout(p),p=setTimeout(function(){d.tinyMCE(j)},500)}}},stupidtable:{init:function(){a(".axiscomposer_pagebuilder").stupidtable().on("aftertablesort",this.add_arrows)},add_arrows:function(b,c){var d=a(this).find("th"),e="asc"===c.direction?"&uarr;":"&darr;",f=c.column;f>1&&(f-=1),d.find(".ac-arrow").remove(),d.eq(f).append('<span class="ac-arrow">'+e+"</span>")}}},e={col_size:[["ac_one_full","1/1",1],["ac_four_fifth","4/5",.8],["ac_three_fourth","3/4",.75],["ac_two_third","2/3",.66],["ac_three_fifth","3/5",.6],["ac_one_half","1/2",.5],["ac_two_fifth","2/5",.4],["ac_one_third","1/3",.33],["ac_one_fourth","1/4",.25],["ac_one_fifth","1/5",.2]],cell_size:[["ac_cell_one_full","1/1",1],["ac_cell_four_fifth","4/5",.8],["ac_cell_three_fourth","3/4",.75],["ac_cell_two_third","2/3",.66],["ac_cell_three_fifth","3/5",.6],["ac_cell_one_half","1/2",.5],["ac_cell_two_fifth","2/5",.4],["ac_cell_one_third","1/3",.33],["ac_cell_one_fourth","1/4",.25],["ac_cell_one_fifth","1/5",.2]],new_cell_order:[["ac_cell_one_full","1/1"],["ac_cell_one_half","1/2"],["ac_cell_one_third","1/3"],["ac_cell_one_fourth","1/4"],["ac_cell_one_fifth","1/5"]],cell_size_variations:{4:{1:["ac_cell_one_fourth","ac_cell_one_fourth","ac_cell_one_fourth","ac_cell_one_fourth"],2:["ac_cell_one_fifth","ac_cell_one_fifth","ac_cell_one_fifth","ac_cell_two_fifth"],3:["ac_cell_one_fifth","ac_cell_one_fifth","ac_cell_two_fifth","ac_cell_one_fifth"],4:["ac_cell_one_fifth","ac_cell_two_fifth","ac_cell_one_fifth","ac_cell_one_fifth"],5:["ac_cell_two_fifth","ac_cell_one_fifth","ac_cell_one_fifth","ac_cell_one_fifth"]},3:{1:["ac_cell_one_third","ac_cell_one_third","ac_cell_one_third"],2:["ac_cell_one_fourth","ac_cell_one_fourth","ac_cell_one_half"],3:["ac_cell_one_fourth","ac_cell_one_half","ac_cell_one_fourth"],4:["ac_cell_one_half","ac_cell_one_fourth","ac_cell_one_fourth"],5:["ac_cell_one_fifth","ac_cell_one_fifth","ac_cell_three_fifth"],6:["ac_cell_one_fifth","ac_cell_three_fifth","ac_cell_one_fifth"],7:["ac_cell_three_fifth","ac_cell_one_fifth","ac_cell_one_fifth"],8:["ac_cell_one_fifth","ac_cell_two_fifth","ac_cell_two_fifth"],9:["ac_cell_two_fifth","ac_cell_one_fifth","ac_cell_two_fifth"],10:["ac_cell_two_fifth","ac_cell_two_fifth","ac_cell_one_fifth"]},2:{1:["ac_cell_one_half","ac_cell_one_half"],2:["ac_cell_two_third","ac_cell_one_third"],3:["ac_cell_one_third","ac_cell_two_third"],4:["ac_cell_one_fourth","ac_cell_three_fourth"],5:["ac_cell_three_fourth","ac_cell_one_fourth"],6:["ac_cell_one_fifth","ac_cell_four_fifth"],7:["ac_cell_four_fifth","ac_cell_one_fifth"],8:["ac_cell_two_fifth","ac_cell_three_fifth"],9:["ac_cell_three_fifth","ac_cell_two_fifth"]}}};d.init()});